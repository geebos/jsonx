# JSON 格式化工具需求文档

## 功能需求

### 1. JSON 格式化展示 ✅
- 以树形结构展示 JSON 数据 ✅
- 支持展开/折叠节点 ✅
  - 支持自由展开/折叠任意层级节点 ✅
  - 支持展开/折叠所有节点 ✅
  - 支持展开/折叠当前节点及其子节点 ✅
  - 支持展开/折叠同级节点 ✅
  - 节点展开/折叠状态持久化 ❌
  - 支持键盘快捷键（Space/Enter 展开/折叠）❌
  - 支持鼠标双击展开/折叠 ✅
- 支持缩进显示 ✅
  - 可配置缩进大小（2/4/8空格）❌
  - 支持自定义缩进字符 ❌
  - 保持缩进对齐 ✅

### 2. 界面布局 ✅
- 树形结构靠左侧展示 ✅
- 右侧弹窗展示详情 ✅
- 清晰的层级关系 ✅
- 展开/折叠图标显示 ✅
  - 使用箭头图标表示展开/折叠状态 ✅
  - 鼠标悬停时显示提示文本 ✅
  - 支持键盘快捷键操作 ❌
- 工具栏功能 ✅
  - 展开/折叠所有按钮 ✅
  - 缩进设置 ❌
  - 搜索/过滤功能 ❌
  - 主题切换 ❌

### 3. 交互功能 ✅
- 点击 key 或 value 触发右侧弹窗 ✅
- 弹窗展示完整的 value 详情 ✅
- 支持关闭弹窗 ✅
- 支持复制值功能 ✅
- 节点操作 ✅
  - 右键菜单支持 ✅
  - 拖拽排序（数组类型）❌
  - 节点搜索高亮 ❌
  - 节点路径导航 ❌

### 4. JSON Path 功能 ✅
- 在弹窗中显示当前节点的完整 JSON Path ✅
- 支持复制 JSON Path ✅
- 路径格式示例：✅
  - 对象属性：`$.user.name` ✅
  - 数组元素：`$.items[0]` ✅
  - 嵌套结构：`$.user.addresses[0].city` ✅
- 路径导航功能 ❌
  - 支持路径输入跳转 ❌
  - 支持路径历史记录 ❌
  - 支持路径收藏 ❌

### 5. 详情展示 ✅
- 使用 textarea 展示格式化的 JSON 字符串 ✅
- 支持自动换行 ✅
- 支持滚动查看 ✅
- 支持复制内容 ✅
- 保持缩进格式 ✅
- 语法高亮 ✅
  - 关键字高亮 ✅
  - 字符串高亮 ✅
  - 数字高亮 ✅
  - 注释支持 ❌

### 6. 增强功能按钮 ❌
- 复制功能 ✅
  - 复制原始值 ✅
  - 复制格式化后的值 ✅
  - 复制 JSON Path ✅
  - 复制为不同格式（YAML/XML）❌
- 压缩功能 ❌
  - 移除所有空白字符 ❌
  - 保持 JSON 有效性 ❌
  - 压缩级别选择 ❌
- 转义功能 ❌
  - 转义特殊字符 ❌
  - 处理 Unicode ❌
  - 支持不同编码格式 ❌
- 其他功能 ❌
  - 下载为文件 ❌
  - 分享链接 ❌
  - 验证 JSON 格式 ❌
  - 导入/导出配置 ❌
  - 历史记录管理 ❌

## 技术实现方案

### 1. 组件结构 ✅
- `JsonTree` 组件：负责树形结构的渲染 ✅
- `JsonNode` 组件：负责单个节点的渲染 ✅
- `JsonValue` 组件：负责不同类型值的渲染 ✅
- `JsonDetail` 组件：负责右侧弹窗展示 ✅
- `JsonPath` 组件：负责路径展示和复制 ✅
- `JsonTextarea` 组件：负责格式化展示 ✅
- `JsonToolbar` 组件：负责功能按钮展示 ✅
- `JsonContextMenu` 组件：负责右键菜单 ✅
- `JsonSearch` 组件：负责搜索功能 ❌
- `JsonSettings` 组件：负责配置管理 ❌

### 2. 数据结构 ✅
- 支持对象、数组、字符串、数字、布尔值、null 等类型 ✅
- 每个节点包含类型、值、子节点信息 ✅
- 记录当前选中的节点信息 ✅
- 维护节点的完整路径信息 ✅
- 节点状态管理 ✅
  - 展开/折叠状态 ✅
  - 选中状态 ✅
  - 高亮状态 ❌
  - 编辑状态 ❌

### 3. 交互功能 ✅
- 点击展开/折叠 ✅
- 点击显示详情 ✅
- 鼠标悬停效果 ✅
- 复制值功能 ✅
- 复制 JSON Path 功能 ✅
- 复制格式化后的 JSON 字符串 ✅
- 压缩/格式化切换 ❌
- 转义/反转义切换 ❌
- 文件下载 ❌
- 分享功能 ❌
- 拖拽排序 ❌
- 右键菜单 ✅
- 键盘导航 ❌
- 搜索过滤 ❌

### 4. 性能优化 ❌
- 虚拟滚动支持 ❌
- 懒加载节点 ❌
- 状态缓存 ❌
- 防抖/节流处理 ❌
- 大数据量优化 ❌

### 5. 可访问性 ❌
- 键盘导航支持 ❌
- 屏幕阅读器支持 ❌
- 高对比度主题 ❌
- 字体大小调整 ❌
- 快捷键支持 ❌

### 6. 国际化 ❌
- 多语言支持 ❌
- 时区处理 ❌
- 数字格式本地化 ❌
- 日期格式本地化 ❌

## 下一步开发计划

### 优先级高
1. 节点展开/折叠状态持久化
2. 键盘快捷键支持
3. 搜索/过滤功能
4. 节点搜索高亮
5. 路径导航功能

### 优先级中
1. 缩进配置
2. 主题切换
3. 拖拽排序
4. 压缩/格式化功能
5. 转义功能

### 优先级低
1. 性能优化
2. 可访问性
3. 国际化
4. 其他增强功能 